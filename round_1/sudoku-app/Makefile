.PHONY: help build run stop restart clean dev logs test

# Default target
help:
	@echo "ðŸ”¥ðŸŽ®ðŸ’¯ Emoji Sudoku - Available Commands:"
	@echo ""
	@echo "  make build     - Build the Docker image"
	@echo "  make run       - Run the app in Docker (http://localhost:3000)"
	@echo "  make stop      - Stop the running container"
	@echo "  make restart   - Restart the container"
	@echo "  make clean     - Stop and remove container + image"
	@echo "  make dev       - Run in development mode (no Docker)"
	@echo "  make logs      - View container logs"
	@echo "  make test      - Run tests"
	@echo ""
	@echo "ðŸ™ Quick start: make build && make run"

# Build the Docker image
build:
	@echo "ðŸ”¨ Building Docker image..."
	docker build -t emoji-sudoku:latest .
	@echo "âœ… Build complete!"

# Run the container
run:
	@echo "ðŸš€ Starting Emoji Sudoku..."
	docker run -d --name emoji-sudoku -p 3000:8080 emoji-sudoku:latest
	@echo "âœ… Running at http://localhost:3000"
	@echo "ðŸ™ Don't forget to try the Linky theme!"

# Stop the container
stop:
	@echo "ðŸ›‘ Stopping container..."
	docker stop emoji-sudoku 2>/dev/null || true
	docker rm emoji-sudoku 2>/dev/null || true
	@echo "âœ… Stopped!"

# Restart the container
restart: stop run

# Clean up everything
clean: stop
	@echo "ðŸ§¹ Cleaning up..."
	docker rmi emoji-sudoku:latest 2>/dev/null || true
	@echo "âœ… Cleaned!"

# Run in development mode (no Docker)
dev:
	@echo "ðŸ”§ Starting development server..."
	npm install
	npm run dev

# View logs
logs:
	@echo "ðŸ“‹ Container logs:"
	docker logs -f emoji-sudoku

# Run tests
test:
	@echo "ðŸ§ª Running tests..."
	npm test

# One command to rule them all
all: build run
	@echo "ðŸŽ‰ All done! Visit http://localhost:3000"
